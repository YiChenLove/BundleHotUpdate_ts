{"version":3,"sources":["assets/Script/bundle/BundleUtil.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import SingleIns from \"./SingleIns\";\n\nexport enum CodeType {\n    BundleModule = \"BundleModule\",\n    BundleHotUIHelper = \"BundleHotUIHelper\",\n    BundleUtil = \"BundleUtil\",\n    BundleManager = \"BundleManager\",\n    BundleUnpackHelper = \"BundleUnpackHelper\",\n}\n\nexport default class BundleUtil extends SingleIns{\n\n    // makeXMLHttp({url: , callback:(retInfo)=>{}})\n    makeXMLHttp(args){\n\n        let {timeout, url, callback} = args\n        let retInfo: any = {}\n\n        let isValid = true\n        let xhr = new XMLHttpRequest();\n        xhr.timeout = Math.ceil((timeout || 6)*1000);\n        xhr.onreadystatechange = function () { \n            if (xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 400)) {\n                if(!isValid){ return } ; isValid = false \n                var httpDatas = JSON.parse(xhr.responseText); \n                callback({retData:httpDatas})\n            }\n            else if (xhr.readyState == 4 && xhr.status == 0) {\n                if(!isValid){ return } ; isValid = false  \n                callback({fail:true})\n\n            }else if (xhr.readyState == 4) {\n                if(!isValid){ return } ; isValid = false  \n                callback({fail:true})\n            }\n        };\n        \n        xhr.open('GET', url, true); \n        xhr.setRequestHeader('Content-Type', 'application/json;charset=UTF-8'); \n        xhr.send();\n        xhr.ontimeout = function () {\n            if(!isValid){ return } ; isValid = false  \n            callback({isTimeout:true})\n        }; \n        retInfo.abort = ()=>{\n            isValid = false\n            xhr.abort()\n        }\n        return retInfo\n    }\n\n    //并行任务 return : {addMis: , onFinish:}  \n    // let pMis = AppComFunc.parallelMis(callback); \n    // pMis.addMis();\n    // pMis.start();\n    // pMis.onFinish\n    parallelMis(callback){\n        let co = 0;\n        let ret: any = {};\n        co = co+1;\n        let isValid = true\n        let retArgs = {}\n        let onFinish :Function = function(args){\n            if(!isValid){ return }\n            co = co-1;\n            if(args){\n                retArgs = Object.assign(retArgs, args)\n            }\n            if(co<=0){\n                if(callback){\n                    callback(retArgs);\n                }\n            }\n        }\n        ret.onFinish = onFinish;\n        ret.addMis = function(){\n            co = co+1;\n            return onFinish;\n        }\n        ret.start = function(){\n            onFinish();\n        }\n        ret.close = function(){\n            isValid = false\n        }\n        return ret;\n    }\n\n    //顺序任务 idx:0~N,  AppComFunc.sequenceMis(misArr, onAllFolderDetectFinish, (curMis, idx, onExec)=>{ })\n    sequenceMis(misArr, onAllExec, execFunc){\n        cc.log(\"sequenceMis__enter_:\")\n        let co = 0\n        let execMis ;\n        execMis = ()=>{\n            if(co>=misArr.length){\n                onAllExec()\n                return \n            }\n            let mis = misArr[co]\n            let curCo = co\n            co=co+1 \n            execFunc(mis, curCo, execMis)\n        } \n        execMis() \n    }\n\n    // comVersion(localVer, romoteVer)\n    // 对比版本号, -1:本地版本比较旧, 0:相等, 1:本地版本比较新\n    comVersion(localVer, romoteVer){\n        let verSplit_local  = localVer.split('.')\n        let verSplit_remote = romoteVer.split('.')\n        let localCo  = verSplit_local.length\n        let remoteCo = verSplit_remote.length\n        let maxCo = localCo>remoteCo?localCo : remoteCo\n        \n        for(let i=0;i<maxCo;i++){\n            let n_local = parseInt(verSplit_local[i], 10); \n            let n_remote = parseInt(verSplit_remote[i], 10); \n\n            if(i<localCo && i>=remoteCo){ return 1 }\n            else if(i>=localCo && i<remoteCo) { return -1} \n            else if(n_local>n_remote){ return 1}\n            else if(n_local<n_remote){ return -1}\n        }\n        return 0\n    }\n\n    createUUID(){\n        var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split(''); \n        var uuid = [];  \n        for (let i = 0; i < 4; i++) {\n            uuid[i] = chars[0 | Math.random()*36];\n        }\n        let uid = uuid.join('');\n        uid = Number(Date.now()).toString(36) + uid \n        return uid\n    }\n\n    public static LOG (key: CodeType,...arg){ \n        cc.log(`${key.toString()}`,...arg) ; \n    }\n}\n"]}